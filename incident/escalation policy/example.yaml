# Version : 2.0
# Changelog :
# =================================================================
# Replaced Recipients with Entity
# Added Type to assist in Parsing Entitites
policy:
  name: My Escalation Policy
  # A custom yaml policy for creating escalation policies
  delay: 10
  # denotes delay in seconds between every level of the policy

  levels:
    # level 0 is reserved for on-call responders
    - name: Level 1
      # denotes the level, should be a positive integral value
      delay: 10
      # denotes the delay in seconds between successive actions
      repeat: 0
      # denotes policy repeatition
      actions:
        - name: Send email
          system: Email
          context: Incident {incident.id} requires attention
          entity: support@example.com
          # can be `entire_team`
          type: email
          # in case of 'entire_team' type should be attribute
        - name: Send SMS
          system: SMS
          entity: +1234567890
          context: Incident {incident.id} requires attention
          type: phone
        - name: Create ticket
          system: Slack
          entity: Development
          # name of the channel, incase not present would post message to general incident channel
          type: channel
          # in case of person, could be user_id
          context: Incident {incident.id} requires attention

    - name: Level 2
      delay: 10
      # denotes the delay in seconds between successive actions
      actions:
        - name: Create ticket
          system: JIRA
          summary: Incident {{incident.id}} requires attention
          # creates an issue using a middleware, webhook->middleware->JIRA Ticket
          context: Please investigate the incident and provide an update
          type: None
          # entity and type would be ignored
        - name: Send email
          system: Email
          entity: manager@example.com, manager2@example.com,  manager3@example.com
          type: None
          # email address comma separated
        - name: Send email
          system: Notify
          entity: 1
          # notify the member using the member id, notify touches every possible touchpoint
          # alternative is 'entire_team'
        - name: Send SMS
          system: Webhook
          entity: https://example.com/webhook
          # webhook to trigger during an incident
          context: Please investigate the incident and provide an update
          # context can be empty
          type: url
          # parse the entity as a url
        - name: Create ticket
          system: JIRA
          summary: Incident {{incident.id}} still requires attention
          description: Please escalate this issue to the next level of support

    - name: Level 3
      actions:
        - name: Send email
          # when system is not specified it throws a validation error
          entity: director@example.com
        - name: Send SMS
          # when system is not specified it throws a validation error
          entity: +1234567890
        - name: Create ticket
          system: JIRA
          summary: Incident {{incident.id}} has not been resolved
          description: Please provide an urgent update on the status of this incident
